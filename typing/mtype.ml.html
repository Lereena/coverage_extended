<html>
  <head>
    <title>Coverage report</title>
    <link rel="stylesheet" href="../coverage.css" />
    <meta charset="utf-8" />
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../index.html">
          <span class="dirname">typing/</span>mtype.ml
        </a>
      </h1>
      <h2>83.33%</h2>
    </div>
    <div id="navbar">
      <span class="some-visited" style="top:11.61%"></span>
      <span class="unvisited" style="top:25.73%"></span>
      <span class="unvisited" style="top:31.91%"></span>
      <span class="some-visited" style="top:34.04%"></span>
      <span class="unvisited" style="top:40.04%"></span>
      <span class="unvisited" style="top:44.49%"></span>
      <span class="unvisited" style="top:57.64%"></span>
      <span class="unvisited" style="top:57.83%"></span>
      <span class="unvisited" style="top:58.03%"></span>
      <span class="unvisited" style="top:58.41%"></span>
      <span class="unvisited" style="top:58.61%"></span>
      <span class="unvisited" style="top:58.80%"></span>
      <span class="unvisited" style="top:58.99%"></span>
      <span class="unvisited" style="top:59.77%"></span>
      <span class="unvisited" style="top:59.96%"></span>
      <span class="unvisited" style="top:60.15%"></span>
      <span class="unvisited" style="top:60.54%"></span>
      <span class="unvisited" style="top:60.74%"></span>
      <span class="unvisited" style="top:61.12%"></span>
      <span class="unvisited" style="top:61.32%"></span>
      <span class="unvisited" style="top:61.51%"></span>
      <span class="unvisited" style="top:61.90%"></span>
      <span class="unvisited" style="top:62.28%"></span>
      <span class="unvisited" style="top:62.86%"></span>
      <span class="unvisited" style="top:64.60%"></span>
      <span class="unvisited" style="top:65.76%"></span>
      <span class="unvisited" style="top:67.12%"></span>
      <span class="unvisited" style="top:67.31%"></span>
      <span class="unvisited" style="top:67.50%"></span>
      <span class="unvisited" style="top:68.86%"></span>
      <span class="unvisited" style="top:69.44%"></span>
      <span class="unvisited" style="top:69.63%"></span>
      <span class="unvisited" style="top:69.83%"></span>
      <span class="unvisited" style="top:70.02%"></span>
      <span class="some-visited" style="top:75.05%"></span>
      <span class="unvisited" style="top:75.24%"></span>
      <span class="unvisited" style="top:75.44%"></span>
      <span class="unvisited" style="top:75.63%"></span>
      <span class="unvisited" style="top:77.56%"></span>
      <span class="some-visited" style="top:86.07%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span > </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span > </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span class="visited"> </span>
<a id="L25"></a><span class="visited"> </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span class="visited"> </span>
<a id="L29"></a><span > </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span class="visited"> </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span > </span>
<a id="L34"></a><span class="visited"> </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span class="visited"> </span>
<a id="L38"></a><span class="visited"> </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span class="visited"> </span>
<a id="L41"></a><span class="visited"> </span>
<a id="L42"></a><span > </span>
<a id="L43"></a><span > </span>
<a id="L44"></a><span class="visited"> </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span > </span>
<a id="L48"></a><span class="visited"> </span>
<a id="L49"></a><span class="visited"> </span>
<a id="L50"></a><span class="visited"> </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span class="visited"> </span>
<a id="L53"></a><span > </span>
<a id="L54"></a><span class="visited"> </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span class="visited"> </span>
<a id="L57"></a><span > </span>
<a id="L58"></a><span class="visited"> </span>
<a id="L59"></a><span class="visited"> </span>
<a id="L60"></a><span class="some-visited"> </span>
<a id="L61"></a><span class="visited"> </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span class="visited"> </span>
<a id="L64"></a><span > </span>
<a id="L65"></a><span class="visited"> </span>
<a id="L66"></a><span class="visited"> </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span class="visited"> </span>
<a id="L69"></a><span > </span>
<a id="L70"></a><span class="visited"> </span>
<a id="L71"></a><span class="visited"> </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span class="visited"> </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span class="visited"> </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span class="visited"> </span>
<a id="L78"></a><span > </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span class="visited"> </span>
<a id="L82"></a><span > </span>
<a id="L83"></a><span class="visited"> </span>
<a id="L84"></a><span class="visited"> </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span class="visited"> </span>
<a id="L87"></a><span > </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span class="visited"> </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span class="visited"> </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span class="visited"> </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span class="visited"> </span>
<a id="L99"></a><span class="visited"> </span>
<a id="L100"></a><span class="visited"> </span>
<a id="L101"></a><span class="visited"> </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span class="visited"> </span>
<a id="L104"></a><span > </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span class="visited"> </span>
<a id="L107"></a><span class="visited"> </span>
<a id="L108"></a><span class="visited"> </span>
<a id="L109"></a><span > </span>
<a id="L110"></a><span class="visited"> </span>
<a id="L111"></a><span class="visited"> </span>
<a id="L112"></a><span class="visited"> </span>
<a id="L113"></a><span class="visited"> </span>
<a id="L114"></a><span > </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span class="visited"> </span>
<a id="L119"></a><span class="visited"> </span>
<a id="L120"></a><span class="visited"> </span>
<a id="L121"></a><span class="visited"> </span>
<a id="L122"></a><span class="visited"> </span>
<a id="L123"></a><span class="visited"> </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span class="visited"> </span>
<a id="L128"></a><span class="visited"> </span>
<a id="L129"></a><span class="visited"> </span>
<a id="L130"></a><span > </span>
<a id="L131"></a><span class="visited"> </span>
<a id="L132"></a><span class="visited"> </span>
<a id="L133"></a><span class="unvisited"> </span>
<a id="L134"></a><span > </span>
<a id="L135"></a><span class="visited"> </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span class="visited"> </span>
<a id="L138"></a><span > </span>
<a id="L139"></a><span class="visited"> </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span > </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span class="visited"> </span>
<a id="L149"></a><span class="visited"> </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span class="visited"> </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span class="visited"> </span>
<a id="L154"></a><span class="visited"> </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span > </span>
<a id="L157"></a><span class="visited"> </span>
<a id="L158"></a><span class="visited"> </span>
<a id="L159"></a><span > </span>
<a id="L160"></a><span class="visited"> </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span class="visited"> </span>
<a id="L163"></a><span > </span>
<a id="L164"></a><span class="visited"> </span>
<a id="L165"></a><span class="unvisited"> </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span class="visited"> </span>
<a id="L169"></a><span class="visited"> </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span class="visited"> </span>
<a id="L172"></a><span class="visited"> </span>
<a id="L173"></a><span class="visited"> </span>
<a id="L174"></a><span class="visited"> </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span class="some-visited"> </span>
<a id="L177"></a><span class="visited"> </span>
<a id="L178"></a><span class="visited"> </span>
<a id="L179"></a><span > </span>
<a id="L180"></a><span > </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span class="visited"> </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span class="visited"> </span>
<a id="L187"></a><span > </span>
<a id="L188"></a><span class="visited"> </span>
<a id="L189"></a><span class="visited"> </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span class="visited"> </span>
<a id="L194"></a><span > </span>
<a id="L195"></a><span class="visited"> </span>
<a id="L196"></a><span > </span>
<a id="L197"></a><span class="visited"> </span>
<a id="L198"></a><span class="visited"> </span>
<a id="L199"></a><span class="visited"> </span>
<a id="L200"></a><span class="visited"> </span>
<a id="L201"></a><span > </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span class="visited"> </span>
<a id="L204"></a><span > </span>
<a id="L205"></a><span class="visited"> </span>
<a id="L206"></a><span > </span>
<a id="L207"></a><span class="unvisited"> </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span class="visited"> </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span class="visited"> </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span > </span>
<a id="L215"></a><span class="visited"> </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span > </span>
<a id="L218"></a><span class="visited"> </span>
<a id="L219"></a><span > </span>
<a id="L220"></a><span class="visited"> </span>
<a id="L221"></a><span class="visited"> </span>
<a id="L222"></a><span > </span>
<a id="L223"></a><span > </span>
<a id="L224"></a><span class="visited"> </span>
<a id="L225"></a><span class="visited"> </span>
<a id="L226"></a><span class="visited"> </span>
<a id="L227"></a><span > </span>
<a id="L228"></a><span class="visited"> </span>
<a id="L229"></a><span class="visited"> </span>
<a id="L230"></a><span class="unvisited"> </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span class="visited"> </span>
<a id="L233"></a><span class="visited"> </span>
<a id="L234"></a><span > </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span class="visited"> </span>
<a id="L237"></a><span class="visited"> </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span class="visited"> </span>
<a id="L241"></a><span class="visited"> </span>
<a id="L242"></a><span class="visited"> </span>
<a id="L243"></a><span class="visited"> </span>
<a id="L244"></a><span > </span>
<a id="L245"></a><span class="visited"> </span>
<a id="L246"></a><span class="visited"> </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span > </span>
<a id="L252"></a><span > </span>
<a id="L253"></a><span > </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span class="visited"> </span>
<a id="L257"></a><span class="visited"> </span>
<a id="L258"></a><span > </span>
<a id="L259"></a><span class="visited"> </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span > </span>
<a id="L262"></a><span class="visited"> </span>
<a id="L263"></a><span class="visited"> </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span > </span>
<a id="L266"></a><span class="visited"> </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span > </span>
<a id="L270"></a><span > </span>
<a id="L271"></a><span > </span>
<a id="L272"></a><span > </span>
<a id="L273"></a><span class="visited"> </span>
<a id="L274"></a><span > </span>
<a id="L275"></a><span > </span>
<a id="L276"></a><span class="visited"> </span>
<a id="L277"></a><span class="visited"> </span>
<a id="L278"></a><span class="visited"> </span>
<a id="L279"></a><span class="visited"> </span>
<a id="L280"></a><span class="visited"> </span>
<a id="L281"></a><span > </span>
<a id="L282"></a><span > </span>
<a id="L283"></a><span class="visited"> </span>
<a id="L284"></a><span class="visited"> </span>
<a id="L285"></a><span class="visited"> </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span class="visited"> </span>
<a id="L288"></a><span > </span>
<a id="L289"></a><span > </span>
<a id="L290"></a><span > </span>
<a id="L291"></a><span class="visited"> </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span class="visited"> </span>
<a id="L294"></a><span > </span>
<a id="L295"></a><span > </span>
<a id="L296"></a><span > </span>
<a id="L297"></a><span > </span>
<a id="L298"></a><span class="unvisited"> </span>
<a id="L299"></a><span class="unvisited"> </span>
<a id="L300"></a><span class="unvisited"> </span>
<a id="L301"></a><span > </span>
<a id="L302"></a><span class="unvisited"> </span>
<a id="L303"></a><span class="unvisited"> </span>
<a id="L304"></a><span class="unvisited"> </span>
<a id="L305"></a><span class="unvisited"> </span>
<a id="L306"></a><span > </span>
<a id="L307"></a><span > </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span class="unvisited"> </span>
<a id="L310"></a><span class="unvisited"> </span>
<a id="L311"></a><span class="unvisited"> </span>
<a id="L312"></a><span > </span>
<a id="L313"></a><span class="unvisited"> </span>
<a id="L314"></a><span class="unvisited"> </span>
<a id="L315"></a><span > </span>
<a id="L316"></a><span class="unvisited"> </span>
<a id="L317"></a><span class="unvisited"> </span>
<a id="L318"></a><span class="unvisited"> </span>
<a id="L319"></a><span > </span>
<a id="L320"></a><span class="unvisited"> </span>
<a id="L321"></a><span > </span>
<a id="L322"></a><span class="unvisited"> </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span > </span>
<a id="L325"></a><span class="unvisited"> </span>
<a id="L326"></a><span > </span>
<a id="L327"></a><span > </span>
<a id="L328"></a><span > </span>
<a id="L329"></a><span > </span>
<a id="L330"></a><span class="visited"> </span>
<a id="L331"></a><span > </span>
<a id="L332"></a><span class="visited"> </span>
<a id="L333"></a><span class="visited"> </span>
<a id="L334"></a><span class="unvisited"> </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span class="visited"> </span>
<a id="L337"></a><span > </span>
<a id="L338"></a><span class="visited"> </span>
<a id="L339"></a><span > </span>
<a id="L340"></a><span class="unvisited"> </span>
<a id="L341"></a><span > </span>
<a id="L342"></a><span > </span>
<a id="L343"></a><span > </span>
<a id="L344"></a><span > </span>
<a id="L345"></a><span > </span>
<a id="L346"></a><span class="visited"> </span>
<a id="L347"></a><span class="unvisited"> </span>
<a id="L348"></a><span class="unvisited"> </span>
<a id="L349"></a><span class="unvisited"> </span>
<a id="L350"></a><span > </span>
<a id="L351"></a><span > </span>
<a id="L352"></a><span > </span>
<a id="L353"></a><span > </span>
<a id="L354"></a><span > </span>
<a id="L355"></a><span > </span>
<a id="L356"></a><span class="unvisited"> </span>
<a id="L357"></a><span > </span>
<a id="L358"></a><span class="visited"> </span>
<a id="L359"></a><span class="unvisited"> </span>
<a id="L360"></a><span class="unvisited"> </span>
<a id="L361"></a><span class="unvisited"> </span>
<a id="L362"></a><span class="unvisited"> </span>
<a id="L363"></a><span > </span>
<a id="L364"></a><span > </span>
<a id="L365"></a><span > </span>
<a id="L366"></a><span class="visited"> </span>
<a id="L367"></a><span > </span>
<a id="L368"></a><span > </span>
<a id="L369"></a><span > </span>
<a id="L370"></a><span > </span>
<a id="L371"></a><span class="visited"> </span>
<a id="L372"></a><span > </span>
<a id="L373"></a><span > </span>
<a id="L374"></a><span > </span>
<a id="L375"></a><span > </span>
<a id="L376"></a><span class="visited"> </span>
<a id="L377"></a><span > </span>
<a id="L378"></a><span > </span>
<a id="L379"></a><span > </span>
<a id="L380"></a><span > </span>
<a id="L381"></a><span > </span>
<a id="L382"></a><span > </span>
<a id="L383"></a><span > </span>
<a id="L384"></a><span > </span>
<a id="L385"></a><span class="visited"> </span>
<a id="L386"></a><span class="visited"> </span>
<a id="L387"></a><span > </span>
<a id="L388"></a><span class="some-visited"> </span>
<a id="L389"></a><span class="unvisited"> </span>
<a id="L390"></a><span class="unvisited"> </span>
<a id="L391"></a><span class="unvisited"> </span>
<a id="L392"></a><span > </span>
<a id="L393"></a><span > </span>
<a id="L394"></a><span class="visited"> </span>
<a id="L395"></a><span class="visited"> </span>
<a id="L396"></a><span > </span>
<a id="L397"></a><span class="visited"> </span>
<a id="L398"></a><span class="visited"> </span>
<a id="L399"></a><span > </span>
<a id="L400"></a><span class="visited"> </span>
<a id="L401"></a><span class="unvisited"> </span>
<a id="L402"></a><span > </span>
<a id="L403"></a><span > </span>
<a id="L404"></a><span > </span>
<a id="L405"></a><span > </span>
<a id="L406"></a><span class="visited"> </span>
<a id="L407"></a><span class="visited"> </span>
<a id="L408"></a><span class="visited"> </span>
<a id="L409"></a><span > </span>
<a id="L410"></a><span > </span>
<a id="L411"></a><span class="visited"> </span>
<a id="L412"></a><span > </span>
<a id="L413"></a><span class="visited"> </span>
<a id="L414"></a><span class="visited"> </span>
<a id="L415"></a><span class="visited"> </span>
<a id="L416"></a><span > </span>
<a id="L417"></a><span class="visited"> </span>
<a id="L418"></a><span > </span>
<a id="L419"></a><span class="visited"> </span>
<a id="L420"></a><span > </span>
<a id="L421"></a><span > </span>
<a id="L422"></a><span class="visited"> </span>
<a id="L423"></a><span > </span>
<a id="L424"></a><span class="visited"> </span>
<a id="L425"></a><span > </span>
<a id="L426"></a><span class="visited"> </span>
<a id="L427"></a><span class="visited"> </span>
<a id="L428"></a><span class="visited"> </span>
<a id="L429"></a><span class="visited"> </span>
<a id="L430"></a><span > </span>
<a id="L431"></a><span > </span>
<a id="L432"></a><span > </span>
<a id="L433"></a><span > </span>
<a id="L434"></a><span > </span>
<a id="L435"></a><span > </span>
<a id="L436"></a><span > </span>
<a id="L437"></a><span > </span>
<a id="L438"></a><span class="visited"> </span>
<a id="L439"></a><span class="visited"> </span>
<a id="L440"></a><span class="visited"> </span>
<a id="L441"></a><span class="visited"> </span>
<a id="L442"></a><span > </span>
<a id="L443"></a><span class="visited"> </span>
<a id="L444"></a><span class="visited"> </span>
<a id="L445"></a><span class="some-visited"> </span>
<a id="L446"></a><span > </span>
<a id="L447"></a><span class="visited"> </span>
<a id="L448"></a><span > </span>
<a id="L449"></a><span class="visited"> </span>
<a id="L450"></a><span > </span>
<a id="L451"></a><span class="visited"> </span>
<a id="L452"></a><span > </span>
<a id="L453"></a><span > </span>
<a id="L454"></a><span class="visited"> </span>
<a id="L455"></a><span > </span>
<a id="L456"></a><span class="visited"> </span>
<a id="L457"></a><span class="visited"> </span>
<a id="L458"></a><span > </span>
<a id="L459"></a><span > </span>
<a id="L460"></a><span > </span>
<a id="L461"></a><span > </span>
<a id="L462"></a><span class="visited"> </span>
<a id="L463"></a><span class="visited"> </span>
<a id="L464"></a><span class="visited"> </span>
<a id="L465"></a><span > </span>
<a id="L466"></a><span class="visited"> </span>
<a id="L467"></a><span class="visited"> </span>
<a id="L468"></a><span > </span>
<a id="L469"></a><span class="visited"> </span>
<a id="L470"></a><span > </span>
<a id="L471"></a><span > </span>
<a id="L472"></a><span class="visited"> </span>
<a id="L473"></a><span > </span>
<a id="L474"></a><span class="visited"> </span>
<a id="L475"></a><span > </span>
<a id="L476"></a><span > </span>
<a id="L477"></a><span class="visited"> </span>
<a id="L478"></a><span > </span>
<a id="L479"></a><span > </span>
<a id="L480"></a><span > </span>
<a id="L481"></a><span class="visited"> </span>
<a id="L482"></a><span class="visited"> </span>
<a id="L483"></a><span > </span>
<a id="L484"></a><span class="visited"> </span>
<a id="L485"></a><span class="visited"> </span>
<a id="L486"></a><span > </span>
<a id="L487"></a><span class="visited"> </span>
<a id="L488"></a><span > </span>
<a id="L489"></a><span > </span>
<a id="L490"></a><span class="visited"> </span>
<a id="L491"></a><span class="visited"> </span>
<a id="L492"></a><span class="visited"> </span>
<a id="L493"></a><span class="visited"> </span>
<a id="L494"></a><span class="visited"> </span>
<a id="L495"></a><span class="visited"> </span>
<a id="L496"></a><span > </span>
<a id="L497"></a><span class="visited"> </span>
<a id="L498"></a><span class="visited"> </span>
<a id="L499"></a><span class="visited"> </span>
<a id="L500"></a><span class="visited"> </span>
<a id="L501"></a><span > </span>
<a id="L502"></a><span > </span>
<a id="L503"></a><span > </span>
<a id="L504"></a><span > </span>
<a id="L505"></a><span > </span>
<a id="L506"></a><span class="visited"> </span>
<a id="L507"></a><span > </span>
<a id="L508"></a><span class="visited"> </span>
<a id="L509"></a><span class="visited"> </span>
<a id="L510"></a><span class="visited"> </span>
<a id="L511"></a><span class="visited"> </span>
<a id="L512"></a><span class="visited"> </span>
<a id="L513"></a><span > </span>
<a id="L514"></a><span > </span>
<a id="L515"></a><span class="visited"> </span>
<a id="L516"></a><span class="visited"> </span>
<a id="L517"></a><span class="visited"> </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
<a href="#L405">405</a>
<a href="#L406">406</a>
<a href="#L407">407</a>
<a href="#L408">408</a>
<a href="#L409">409</a>
<a href="#L410">410</a>
<a href="#L411">411</a>
<a href="#L412">412</a>
<a href="#L413">413</a>
<a href="#L414">414</a>
<a href="#L415">415</a>
<a href="#L416">416</a>
<a href="#L417">417</a>
<a href="#L418">418</a>
<a href="#L419">419</a>
<a href="#L420">420</a>
<a href="#L421">421</a>
<a href="#L422">422</a>
<a href="#L423">423</a>
<a href="#L424">424</a>
<a href="#L425">425</a>
<a href="#L426">426</a>
<a href="#L427">427</a>
<a href="#L428">428</a>
<a href="#L429">429</a>
<a href="#L430">430</a>
<a href="#L431">431</a>
<a href="#L432">432</a>
<a href="#L433">433</a>
<a href="#L434">434</a>
<a href="#L435">435</a>
<a href="#L436">436</a>
<a href="#L437">437</a>
<a href="#L438">438</a>
<a href="#L439">439</a>
<a href="#L440">440</a>
<a href="#L441">441</a>
<a href="#L442">442</a>
<a href="#L443">443</a>
<a href="#L444">444</a>
<a href="#L445">445</a>
<a href="#L446">446</a>
<a href="#L447">447</a>
<a href="#L448">448</a>
<a href="#L449">449</a>
<a href="#L450">450</a>
<a href="#L451">451</a>
<a href="#L452">452</a>
<a href="#L453">453</a>
<a href="#L454">454</a>
<a href="#L455">455</a>
<a href="#L456">456</a>
<a href="#L457">457</a>
<a href="#L458">458</a>
<a href="#L459">459</a>
<a href="#L460">460</a>
<a href="#L461">461</a>
<a href="#L462">462</a>
<a href="#L463">463</a>
<a href="#L464">464</a>
<a href="#L465">465</a>
<a href="#L466">466</a>
<a href="#L467">467</a>
<a href="#L468">468</a>
<a href="#L469">469</a>
<a href="#L470">470</a>
<a href="#L471">471</a>
<a href="#L472">472</a>
<a href="#L473">473</a>
<a href="#L474">474</a>
<a href="#L475">475</a>
<a href="#L476">476</a>
<a href="#L477">477</a>
<a href="#L478">478</a>
<a href="#L479">479</a>
<a href="#L480">480</a>
<a href="#L481">481</a>
<a href="#L482">482</a>
<a href="#L483">483</a>
<a href="#L484">484</a>
<a href="#L485">485</a>
<a href="#L486">486</a>
<a href="#L487">487</a>
<a href="#L488">488</a>
<a href="#L489">489</a>
<a href="#L490">490</a>
<a href="#L491">491</a>
<a href="#L492">492</a>
<a href="#L493">493</a>
<a href="#L494">494</a>
<a href="#L495">495</a>
<a href="#L496">496</a>
<a href="#L497">497</a>
<a href="#L498">498</a>
<a href="#L499">499</a>
<a href="#L500">500</a>
<a href="#L501">501</a>
<a href="#L502">502</a>
<a href="#L503">503</a>
<a href="#L504">504</a>
<a href="#L505">505</a>
<a href="#L506">506</a>
<a href="#L507">507</a>
<a href="#L508">508</a>
<a href="#L509">509</a>
<a href="#L510">510</a>
<a href="#L511">511</a>
<a href="#L512">512</a>
<a href="#L513">513</a>
<a href="#L514">514</a>
<a href="#L515">515</a>
<a href="#L516">516</a>
<a href="#L517">517</a>
</pre>
        <pre id="code">
(**************************************************************************)
(*                                                                        *)
(*                                 OCaml                                  *)
(*                                                                        *)
(*             Xavier Leroy, projet Cristal, INRIA Rocquencourt           *)
(*                                                                        *)
(*   Copyright 1996 Institut National de Recherche en Informatique et     *)
(*     en Automatique.                                                    *)
(*                                                                        *)
(*   All rights reserved.  This file is distributed under the terms of    *)
(*   the GNU Lesser General Public License version 2.1, with the          *)
(*   special exception on linking described in the file LICENSE.          *)
(*                                                                        *)
(**************************************************************************)

(* Operations on module types *)

open Asttypes
open Path
open Types


let rec scrape env mty =
  <span data-count="7651">m</span>atch mty with
    <span data-count="478">M</span>ty_ident p -&gt;
      begin try
        scrape env (Env.find_modtype_expansion p env)
      with <span data-count="51">N</span>ot_found -&gt;
        mty
      end
  | <span data-count="7173">_</span> -&gt; mty

let freshen ~scope mty =
  <span data-count="203">S</span>ubst.modtype (Rescope scope) Subst.identity mty

let rec strengthen ~aliasable env mty p =
  <span data-count="6176">m</span>atch scrape env mty with
    <span data-count="4728">M</span>ty_signature sg -&gt;
      Mty_signature(strengthen_sig ~aliasable env sg p)
  | <span data-count="575">M</span>ty_functor(param, arg, res)
    when <span data-count="1200">!</span>Clflags.applicative_functors &amp;&amp; <span data-count="600">I</span>dent.name param &lt;&gt; "*" -&gt;
      Mty_functor(param, arg,
        strengthen ~aliasable:false env res (Papply(p, Pident param)))
  | <span data-count="873">m</span>ty -&gt;
      mty

and strengthen_sig ~aliasable env sg p =
  <span data-count="64389">m</span>atch sg with
    <span data-count="4728">[</span>] -&gt; []
  | <span data-count="51631">(</span>Sig_value(_, _, _) as sigelt) :: rem -&gt;
      sigelt :: strengthen_sig ~aliasable env rem p
  | <span data-count="10">S</span>ig_type(id, {type_kind=Type_abstract}, _, _) ::
    (Sig_type(id', {type_private=Private}, _, _) :: _ as rem)
    when <span data-count="90">I</span>dent.name id = Ident.name id' ^ "#row" -&gt;
      strengthen_sig ~aliasable env rem p
  | <span data-count="5238">S</span>ig_type(id, decl, rs, vis) :: rem -&gt;
      let newdecl =
        <span data-count="5238">m</span>atch decl.type_manifest, decl.type_private, decl.type_kind with
          <span data-count="2560">S</span>ome _, Public, _ -&gt; decl
        | <span data-count="47">S</span>ome _, Private, (<span data-count="47">T</span>ype_record _ | <span data-count="0">T</span>ype_variant _) -&gt; decl
        | <span data-count="2631">_</span> -&gt;
            let manif =
              <span data-count="2631">S</span>ome(Btype.newgenty(Tconstr(Pdot(p, Ident.name id),
                                          decl.type_params, ref Mnil))) in
            <span data-count="2631">i</span>f decl.type_kind = Type_abstract then
              <span data-count="1257">{</span> decl with type_private = Public; type_manifest = manif }
            else
              <span data-count="1374">{</span> decl with type_manifest = manif }
      in
      <span data-count="5238">S</span>ig_type(id, newdecl, rs, vis) :: strengthen_sig ~aliasable env rem p
  | <span data-count="449">(</span>Sig_typext _ as sigelt) :: rem -&gt;
      sigelt :: strengthen_sig ~aliasable env rem p
  | <span data-count="1570">S</span>ig_module(id, pres, md, rs, vis) :: rem -&gt;
      let str =
        <span data-count="1570">s</span>trengthen_decl ~aliasable env md (Pdot(p, Ident.name id))
      in
      <span data-count="1570">S</span>ig_module(id, pres, str, rs, vis)
      :: strengthen_sig ~aliasable
        (Env.add_module_declaration ~check:false id pres md env) rem p
      (* Need to add the module in case it defines manifest module types *)
  | <span data-count="382">S</span>ig_modtype(id, decl, vis) :: rem -&gt;
      let newdecl =
        <span data-count="382">m</span>atch decl.mtd_type with
          <span data-count="4">N</span>one -&gt;
            {decl with mtd_type = Some(Mty_ident(Pdot(p,Ident.name id)))}
        | <span data-count="378">S</span>ome _ -&gt;
            decl
      in
      <span data-count="382">S</span>ig_modtype(id, newdecl, vis) ::
      strengthen_sig ~aliasable (Env.add_modtype id decl env) rem p
      (* Need to add the module type in case it is manifest *)
  | <span data-count="155">(</span>Sig_class _ as sigelt) :: rem -&gt;
      sigelt :: strengthen_sig ~aliasable env rem p
  | <span data-count="226">(</span>Sig_class_type _ as sigelt) :: rem -&gt;
      sigelt :: strengthen_sig ~aliasable env rem p

and strengthen_decl ~aliasable env md p =
  <span data-count="1621">m</span>atch md.md_type with
  | <span data-count="259">M</span>ty_alias _ -&gt; md
  | <span data-count="1113">_</span> when <span data-count="1362">a</span>liasable -&gt; {md with md_type = Mty_alias p}
  | <span data-count="249">m</span>ty -&gt; {md with md_type = strengthen ~aliasable env mty p}

let () = <span data-count="1170">E</span>nv.strengthen := strengthen

let rec make_aliases_absent pres mty =
  <span data-count="121">m</span>atch mty with
  | <span data-count="22">M</span>ty_alias _ -&gt; Mp_absent, mty
  | <span data-count="68">M</span>ty_signature sg -&gt;
      pres, Mty_signature(make_aliases_absent_sig sg)
  | <span data-count="8">M</span>ty_functor(param, arg, res) -&gt;
      let _, res = <span data-count="8">m</span>ake_aliases_absent Mp_present res in
      <span data-count="8">p</span>res, Mty_functor(param, arg, res)
  | <span data-count="23">m</span>ty -&gt;
      pres, mty

and make_aliases_absent_sig sg =
  match sg with
    <span data-count="68">[</span>] -&gt; []
  | <span data-count="41">S</span>ig_module(id, pres, md, rs, priv) :: rem -&gt;
      let pres, md_type = <span data-count="41">m</span>ake_aliases_absent pres md.md_type in
      <span data-count="41">l</span>et md = <span data-count="41">{</span> md with md_type } in
      <span data-count="41">S</span>ig_module(id, pres, md, rs, priv) :: make_aliases_absent_sig rem
  | <span data-count="662">s</span>igelt :: rem -&gt;
      sigelt :: make_aliases_absent_sig rem

let scrape_for_type_of env pres mty =
  <span data-count="72">l</span>et rec loop env path mty =
    <span data-count="90">m</span>atch mty, path with
    | <span data-count="18">M</span>ty_alias path, _ -&gt; begin
        try
          let md = <span data-count="18">E</span>nv.find_module path env in
          <span data-count="18">l</span>oop env (Some path) md.md_type
        with <span data-count="0">N</span>ot_found -&gt; mty
      end
    | <span data-count="16">m</span>ty, Some path -&gt;
        strengthen ~aliasable:false env mty path
    | <span data-count="56">_</span> -&gt; mty
  in
  <span data-count="72">m</span>ake_aliases_absent pres (loop env None mty)

(* In nondep_supertype, env is only used for the type it assigns to id.
   Hence there is no need to keep env up-to-date by adding the bindings
   traversed. *)

type variance = Co | Contra | Strict

let rec nondep_mty_with_presence env va ids pres mty =
  <span data-count="182">m</span>atch mty with
    <span data-count="15">M</span>ty_ident p -&gt;
      begin match Path.find_free_opt ids p with
      | <span data-count="6">S</span>ome id -&gt;
          let expansion =
            <span data-count="6">t</span>ry Env.find_modtype_expansion p env
            with <span data-count="4">N</span>ot_found -&gt;
              raise (Ctype.Nondep_cannot_erase id)
          in
          <span data-count="2">n</span>ondep_mty_with_presence env va ids pres expansion
      | <span data-count="9">N</span>one -&gt; pres, mty
      end
  | <span data-count="25">M</span>ty_alias p -&gt;
      begin match Path.find_free_opt ids p with
      | <span data-count="4">S</span>ome id -&gt;
          let expansion =
            <span data-count="4">t</span>ry Env.find_module p env
            with <span data-count="0">N</span>ot_found -&gt;
              raise (Ctype.Nondep_cannot_erase id)
          in
          <span data-count="4">n</span>ondep_mty_with_presence env va ids Mp_present expansion.md_type
      | <span data-count="21">N</span>one -&gt; pres, mty
      end
  | <span data-count="137">M</span>ty_signature sg -&gt;
      let mty = <span data-count="137">M</span>ty_signature(nondep_sig env va ids sg) in
      <span data-count="135">p</span>res, mty
  | <span data-count="5">M</span>ty_functor(param, arg, res) -&gt;
      let var_inv =
        <span data-count="5">m</span>atch va with <span data-count="5">C</span>o -&gt; Contra | <span data-count="0">C</span>ontra -&gt; Co | <span data-count="0">S</span>trict -&gt; Strict in
      <span data-count="5">l</span>et mty =
        <span data-count="5">M</span>ty_functor(param, Option.map (nondep_mty env var_inv ids) arg,
                    nondep_mty
                      (Env.add_module ~arg:true param Mp_present
                         (Btype.default_mty arg) env) va ids res)
      in
      <span data-count="3">p</span>res, mty

and nondep_mty env va ids mty =
  <span data-count="118">s</span>nd (nondep_mty_with_presence env va ids Mp_present mty)

and nondep_sig_item env va ids = <span data-count="958">f</span>unction
  | <span data-count="1309">S</span>ig_value(id, d, vis) -&gt;
      Sig_value(id,
                {d with val_type = Ctype.nondep_type env ids d.val_type},
                vis)
  | <span data-count="360">S</span>ig_type(id, d, rs, vis) -&gt;
      Sig_type(id, Ctype.nondep_type_decl env ids (va = Co) d, rs, vis)
  | <span data-count="79">S</span>ig_typext(id, ext, es, vis) -&gt;
      Sig_typext(id, Ctype.nondep_extension_constructor env ids ext, es, vis)
  | <span data-count="58">S</span>ig_module(id, pres, md, rs, vis) -&gt;
      let pres, mty = <span data-count="58">n</span>ondep_mty_with_presence env va ids pres md.md_type in
      <span data-count="56">S</span>ig_module(id, pres, {md with md_type = mty}, rs, vis)
  | <span data-count="42">S</span>ig_modtype(id, d, vis) -&gt;
      begin try
        Sig_modtype(id, nondep_modtype_decl env ids d, vis)
      with <span data-count="2">C</span>type.Nondep_cannot_erase _ as exn -&gt;
        match va with
          <span data-count="2">C</span>o -&gt; Sig_modtype(id, {mtd_type=None; mtd_loc=Location.none;
                                 mtd_attributes=[]}, vis)
        | <span data-count="0">_</span>  -&gt; raise exn
      end
  | <span data-count="41">S</span>ig_class(id, d, rs, vis) -&gt;
      Sig_class(id, Ctype.nondep_class_declaration env ids d, rs, vis)
  | <span data-count="82">S</span>ig_class_type(id, d, rs, vis) -&gt;
      Sig_class_type(id, Ctype.nondep_cltype_declaration env ids d, rs, vis)

and nondep_sig env va ids sg =
  <span data-count="137">L</span>ist.map (nondep_sig_item env va ids) sg

and nondep_modtype_decl env ids mtd =
  <span data-count="42">{</span>mtd with mtd_type = Option.map (nondep_mty env Strict ids) mtd.mtd_type}

let nondep_supertype env ids = <span data-count="86">n</span>ondep_mty env Co ids
let nondep_sig_item env ids = <span data-count="821">n</span>ondep_sig_item env Co ids

let enrich_typedecl env p id decl =
  <span data-count="65">m</span>atch decl.type_manifest with
    <span data-count="33">S</span>ome _ -&gt; decl
  | <span data-count="32">N</span>one -&gt;
      try
        let orig_decl = <span data-count="32">E</span>nv.find_type p env in
        <span data-count="24">i</span>f decl.type_arity &lt;&gt; orig_decl.type_arity then
          <span data-count="0">d</span>ecl
        else
          <span data-count="24">l</span>et orig_ty =
            <span data-count="24">C</span>type.reify_univars
              (Btype.newgenty(Tconstr(p, orig_decl.type_params, ref Mnil)))
          in
          <span data-count="24">l</span>et new_ty =
            <span data-count="24">C</span>type.reify_univars
              (Btype.newgenty(Tconstr(Pident id, decl.type_params, ref Mnil)))
          in
          <span data-count="24">l</span>et env = <span data-count="24">E</span>nv.add_type ~check:false id decl env in
          <span data-count="24">C</span>type.mcomp env orig_ty new_ty;
          <span data-count="18">l</span>et orig_ty =
            <span data-count="18">B</span>type.newgenty(Tconstr(p, decl.type_params, ref Mnil))
          in
          <span data-count="18">{</span>decl with type_manifest = Some orig_ty}
      with <span data-count="8">N</span>ot_found | <span data-count="6">C</span>type.Unify _ -&gt;
        (* - Not_found: type which was not present in the signature, so we don't
           have anything to do.
           - Unify: the current declaration is not compatible with the one we
           got from the signature. We should just fail now, but then, we could
           also have failed if the arities of the two decls were different,
           which we didn't. *)
        decl

let rec enrich_modtype env p mty =
  <span data-count="21">m</span>atch mty with
    <span data-count="13">M</span>ty_signature sg -&gt;
      Mty_signature(List.map (enrich_item env p) sg)
  | <span data-count="8">_</span> -&gt;
      mty

and enrich_item env p = <span data-count="13">f</span>unction
    <span data-count="16">S</span>ig_type(id, decl, rs, priv) -&gt;
      Sig_type(id,
                enrich_typedecl env (Pdot(p, Ident.name id)) id decl, rs, priv)
  | <span data-count="1">S</span>ig_module(id, pres, md, rs, priv) -&gt;
      Sig_module(id, pres,
                  {md with
                   md_type = enrich_modtype env
                       (Pdot(p, Ident.name id)) md.md_type},
                 rs,
                 priv)
  | <span data-count="198">i</span>tem -&gt; item

let rec type_paths env p mty =
  <span data-count="379">m</span>atch scrape env mty with
    <span data-count="4">M</span>ty_ident _ -&gt; []
  | <span data-count="12">M</span>ty_alias _ -&gt; []
  | <span data-count="359">M</span>ty_signature sg -&gt; type_paths_sig env p sg
  | <span data-count="4">M</span>ty_functor _ -&gt; []

and type_paths_sig env p sg =
  <span data-count="1296">m</span>atch sg with
    <span data-count="359">[</span>] -&gt; []
  | <span data-count="266">S</span>ig_type(id, _decl, _, _) :: rem -&gt;
      Pdot(p, Ident.name id) :: type_paths_sig env p rem
  | <span data-count="53">S</span>ig_module(id, pres, md, _, _) :: rem -&gt;
      type_paths env (Pdot(p, Ident.name id)) md.md_type @
      type_paths_sig (Env.add_module_declaration ~check:false id pres md env)
        p rem
  | <span data-count="2">S</span>ig_modtype(id, decl, _) :: rem -&gt;
      type_paths_sig (Env.add_modtype id decl env) p rem
  | <span data-count="616">(</span><span data-count="594">S</span>ig_value _ | <span data-count="8">S</span>ig_typext _ | <span data-count="7">S</span>ig_class _ | <span data-count="7">S</span>ig_class_type _) :: rem -&gt;
      type_paths_sig env p rem


let rec no_code_needed_mod env pres mty =
  <span data-count="0">m</span>atch pres with
  | <span data-count="0">M</span>p_absent -&gt; true
  | <span data-count="0">M</span>p_present -&gt; begin
      match scrape env mty with
        <span data-count="0">M</span>ty_ident _ -&gt; false
      | <span data-count="0">M</span>ty_signature sg -&gt; no_code_needed_sig env sg
      | <span data-count="0">M</span>ty_functor _ -&gt; false
      | <span data-count="0">M</span>ty_alias _ -&gt; false
    end

and no_code_needed_sig env sg =
  <span data-count="0">m</span>atch sg with
    <span data-count="0">[</span>] -&gt; true
  | <span data-count="0">S</span>ig_value(_id, decl, _) :: rem -&gt;
      begin match decl.val_kind with
      | <span data-count="0">V</span>al_prim _ -&gt; no_code_needed_sig env rem
      | <span data-count="0">_</span> -&gt; false
      end
  | <span data-count="0">S</span>ig_module(id, pres, md, _, _) :: rem -&gt;
      <span data-count="0">n</span>o_code_needed_mod env pres md.md_type &amp;&amp;
      <span data-count="0">n</span>o_code_needed_sig
        (Env.add_module_declaration ~check:false id pres md env) rem
  | <span data-count="0">(</span><span data-count="0">S</span>ig_type _ | <span data-count="0">S</span>ig_modtype _ | <span data-count="0">S</span>ig_class_type _) :: rem -&gt;
      no_code_needed_sig env rem
  | <span data-count="0">(</span><span data-count="0">S</span>ig_typext _ | <span data-count="0">S</span>ig_class _) :: _ -&gt;
      false

let no_code_needed env mty = <span data-count="0">n</span>o_code_needed_mod env Mp_present mty

(* Check whether a module type may return types *)

let rec contains_type env = function
    <span data-count="8">M</span>ty_ident path -&gt;
      begin try match (Env.find_modtype path env).mtd_type with
      | <span data-count="1">N</span>one -&gt; raise Exit (* PR#6427 *)
      | <span data-count="7">S</span>ome mty -&gt; contains_type env mty
      with <span data-count="0">N</span>ot_found -&gt; raise Exit
      end
  | <span data-count="7">M</span>ty_signature sg -&gt;
      contains_type_sig env sg
  | <span data-count="4">M</span>ty_functor (_, _, body) -&gt;
      contains_type env body
  | <span data-count="0">M</span>ty_alias _ -&gt;
      ()

and contains_type_sig env = List.iter (contains_type_item env)

and contains_type_item env = function
    <span data-count="3">S</span>ig_type (_,(<span data-count="3">{</span>type_manifest = None} |
                 <span data-count="0">{</span>type_kind = Type_abstract; type_private = Private}),_, _)
  | <span data-count="0">S</span>ig_modtype _
  | <span data-count="0">S</span>ig_typext (_, {ext_args = Cstr_record _}, _, _) -&gt;
      (* We consider that extension constructors with an inlined
         record create a type (the inlined record), even though
         it would be technically safe to ignore that considering
         the current constraints which guarantee that this type
         is kept local to expressions.  *)
      raise Exit
  | <span data-count="0">S</span>ig_module (_, _, {md_type = mty}, _, _) -&gt;
      contains_type env mty
  | <span data-count="4">S</span>ig_value _
  | <span data-count="0">S</span>ig_type _
  | <span data-count="0">S</span>ig_typext _
  | <span data-count="0">S</span>ig_class _
  | <span data-count="0">S</span>ig_class_type _ -&gt;
      ()

let contains_type env mty =
  <span data-count="8">t</span>ry contains_type env mty; <span data-count="4">f</span>alse with <span data-count="4">E</span>xit -&gt; true


(* Remove module aliases from a signature *)

let rec get_prefixes = <span data-count="1170">f</span>unction
  | Pident _ -&gt; Path.Set.empty
  | Pdot (p, _)
  | Papply (p, _) -&gt; Path.Set.add p (get_prefixes p)

let rec get_arg_paths = <span data-count="1170">f</span>unction
  | Pident _ -&gt; Path.Set.empty
  | Pdot (p, _) -&gt; get_arg_paths p
  | Papply (p1, p2) -&gt;
      Path.Set.add p2
        (Path.Set.union (get_prefixes p2)
           (Path.Set.union (get_arg_paths p1) (get_arg_paths p2)))

let rec rollback_path subst p =
  <span data-count="24">t</span>ry Pident (Path.Map.find p subst)
  with <span data-count="18">N</span>ot_found -&gt;
    match p with
      <span data-count="18">P</span>ident _ | <span data-count="0">P</span>apply _ -&gt; p
    | <span data-count="0">P</span>dot (p1, s) -&gt;
        let p1' = <span data-count="0">r</span>ollback_path subst p1 in
        <span data-count="0">i</span>f Path.same p1 p1' then <span data-count="0">p</span> else <span data-count="0">r</span>ollback_path subst (Pdot (p1', s))

let rec collect_ids subst bindings p =
    <span data-count="24">b</span>egin match rollback_path subst p with
      <span data-count="24">P</span>ident id -&gt;
        let ids =
          <span data-count="24">t</span>ry collect_ids subst bindings (Ident.find_same id bindings)
          with <span data-count="16">N</span>ot_found -&gt; Ident.Set.empty
        in
        <span data-count="24">I</span>dent.Set.add id ids
    | <span data-count="0">_</span> -&gt; Ident.Set.empty
    end

let collect_arg_paths mty =
  let open Btype in
  let paths = <span data-count="11">r</span>ef Path.Set.empty
  and subst = <span data-count="11">r</span>ef Path.Map.empty
  and bindings = <span data-count="11">r</span>ef Ident.empty in
  (* let rt = Ident.create "Root" in
     and prefix = ref (Path.Pident rt) in *)
  <span data-count="11">l</span>et it_path p = <span data-count="508">p</span>aths := Path.Set.union (get_arg_paths p) !paths
  and it_signature_item it si =
    <span data-count="212">t</span>ype_iterators.it_signature_item it si;
    <span data-count="212">m</span>atch si with
    | <span data-count="16">S</span>ig_module (id, _, {md_type=Mty_alias p}, _, _) -&gt;
        bindings := Ident.add id p !bindings
    | <span data-count="12">S</span>ig_module (id, _, {md_type=Mty_signature sg}, _, _) -&gt;
        List.iter
          (function <span data-count="8">S</span>ig_module (id', _, _, _, _) -&gt;
              subst :=
                Path.Map.add (Pdot (Pident id, Ident.name id')) id' !subst
            | <span data-count="4">_</span> -&gt; ())
          sg
    | <span data-count="184">_</span> -&gt; ()
  in
  <span data-count="11">l</span>et it = <span data-count="11">{</span>type_iterators with it_path; it_signature_item} in
  <span data-count="11">i</span>t.it_module_type it mty;
  <span data-count="11">i</span>t.it_module_type unmark_iterators mty;
  <span data-count="11">P</span>ath.Set.fold (fun p -&gt; <span data-count="16">I</span>dent.Set.union (collect_ids !subst !bindings p))
    !paths Ident.Set.empty

type remove_alias_args =
    { mutable modified: bool;
      exclude: Ident.t -&gt; Path.t -&gt; bool;
      scrape: Env.t -&gt; module_type -&gt; module_type }

let rec remove_aliases_mty env args pres mty =
  <span data-count="579">l</span>et args' = <span data-count="579">{</span>args with modified = false} in
  <span data-count="579">l</span>et res =
    <span data-count="579">m</span>atch args.scrape env mty with
      <span data-count="492">M</span>ty_signature sg -&gt;
        Mp_present, Mty_signature (remove_aliases_sig env args' sg)
    | <span data-count="38">M</span>ty_alias _ -&gt;
        let mty' = <span data-count="38">E</span>nv.scrape_alias env mty in
        <span data-count="38">i</span>f mty' = mty then <span data-count="0">b</span>egin
          pres, mty
        end else <span data-count="38">b</span>egin
          args'.modified &lt;- true;
          <span data-count="38">r</span>emove_aliases_mty env args' Mp_present mty'
        end
    | <span data-count="49">m</span>ty -&gt;
        Mp_present, mty
  in
  <span data-count="579">i</span>f args'.modified then <span data-count="77">b</span>egin
    args.modified &lt;- true;
    <span data-count="77">r</span>es
  end else <span data-count="502">b</span>egin
    pres, mty
  end

and remove_aliases_sig env args sg =
  <span data-count="1496">m</span>atch sg with
    <span data-count="492">[</span>] -&gt; []
  | <span data-count="147">S</span>ig_module(id, pres, md, rs, priv) :: rem  -&gt;
      let pres, mty =
        <span data-count="147">m</span>atch md.md_type with
          <span data-count="14">M</span>ty_alias p when <span data-count="52">a</span>rgs.exclude id p -&gt;
            pres, md.md_type
        | <span data-count="133">m</span>ty -&gt;
            remove_aliases_mty env args pres mty
      in
      <span data-count="147">S</span>ig_module(id, pres, {md with md_type = mty} , rs, priv) ::
      remove_aliases_sig (Env.add_module id pres mty env) args rem
  | <span data-count="18">S</span>ig_modtype(id, mtd, priv) :: rem -&gt;
      Sig_modtype(id, mtd, priv) ::
      remove_aliases_sig (Env.add_modtype id mtd env) args rem
  | <span data-count="839">i</span>t :: rem -&gt;
      it :: remove_aliases_sig env args rem

let scrape_for_functor_arg env mty =
  <span data-count="397">l</span>et exclude _id p =
    <span data-count="36">t</span>ry ignore (Env.find_module p env); <span data-count="6">t</span>rue with <span data-count="30">N</span>ot_found -&gt; false
  in
  <span data-count="397">l</span>et _, mty =
    <span data-count="397">r</span>emove_aliases_mty env {modified=false; exclude; scrape} Mp_present mty
  in
  <span data-count="397">m</span>ty

let scrape_for_type_of ~remove_aliases env mty =
  <span data-count="83">i</span>f remove_aliases then <span data-count="11">b</span>egin
    let excl = <span data-count="11">c</span>ollect_arg_paths mty in
    <span data-count="11">l</span>et exclude id _p = <span data-count="16">I</span>dent.Set.mem id excl in
    <span data-count="11">l</span>et scrape _ mty = <span data-count="39">m</span>ty in
    <span data-count="11">l</span>et _, mty =
      <span data-count="11">r</span>emove_aliases_mty env {modified=false; exclude; scrape} Mp_present mty
    in
    <span data-count="11">m</span>ty
  end else <span data-count="72">b</span>egin
    let _, mty = <span data-count="72">s</span>crape_for_type_of env Mp_present mty in
    <span data-count="72">m</span>ty
  end

(* Lower non-generalizable type variables *)

let lower_nongen nglev mty =
  <span data-count="1734">l</span>et open Btype in
  let it_type_expr it ty =
    <span data-count="34412">l</span>et ty = <span data-count="34412">r</span>epr ty in
    <span data-count="34412">m</span>atch ty with
      <span data-count="6372">{</span>desc=Tvar _; level} -&gt;
        if <span data-count="6372">l</span>evel &lt; generic_level &amp;&amp; <span data-count="48">l</span>evel &gt; nglev then <span data-count="11">s</span>et_level ty nglev
    | <span data-count="28040">_</span> -&gt;
        type_iterators.it_type_expr it ty
  in
  <span data-count="1734">l</span>et it = <span data-count="1734">{</span>type_iterators with it_type_expr} in
  <span data-count="1734">i</span>t.it_module_type it mty;
  <span data-count="1734">i</span>t.it_module_type unmark_iterators mty
</pre>
      </div>
    </div>
    <div id="footer">Generated on 2019-08-14 11:29:20 by <a href="https://github.com/aantron/bisect_ppx">Bisect_ppx</a> 1.4.1</div>
    <script src="../coverage.js"></script>
  </body>
</html>
